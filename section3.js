// üîí Clickjacking ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?
// Clickjacking = ‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß
// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÜ:
// ‡∏°‡∏µ‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏ú‡πà‡∏≤‡∏ô <iframe> ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏≠‡∏ö‡∏ß‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏ï‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏•‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡∏°‡∏±‡∏ô 
// ‡∏û‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‚Äú‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‚Äù) ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß
import express from "express"
const app = express();

//‡πÉ‡∏ä‡πâ HTTP Header: X-Frame-Options
// ‡∏ö‡∏≠‡∏Å browser ‡∏ß‡πà‡∏≤ ‡∏´‡πâ‡∏≤‡∏°‡∏ù‡∏±‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡∏≤‡πÉ‡∏ô iframe ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏∑‡πà‡∏ô

app.use((req, res, next) => {
// DENY = ‡∏´‡πâ‡∏≤‡∏°‡∏ù‡∏±‡∏á iframe ‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ
// SAMEORIGIN = ‡∏ù‡∏±‡∏á iframe ‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  res.setHeader('X-Frame-Options', 'DENY'); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô iframe
  next();
});

app.get('/', (req, res) => {
//‡πÉ‡∏ä‡πâ Frame-Busting Script
// ‡πÄ‡∏û‡∏¥‡πà‡∏° JavaScript ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ô iframe ‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‚Äî ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà ‡πÉ‡∏´‡πâ redirect ‡∏≠‡∏≠‡∏Å
// window.top = ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ö‡∏ô‡∏™‡∏∏‡∏î
// window.self = ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
// ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô = ‡πÄ‡∏£‡∏≤‡πÇ‡∏î‡∏ô iframe ‡∏ù‡∏±‡∏á‡πÑ‡∏ß‡πâ ‚ûú ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö redirect ‡∏≠‡∏≠‡∏Å
  res.send(`
    <h1>‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏à‡∏≤‡∏Å Clickjacking</h1>
    <button onclick="alert('‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß!')">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏â‡∏±‡∏ô</button>
    <script>
      if (window.top !== window.self) {
        window.top.location = window.location; // Frame-busting
      }
    </script>
  `);
});

app.listen(3001, () => console.log('Server running on port 3001'));